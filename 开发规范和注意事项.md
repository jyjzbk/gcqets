# å®éªŒæ•™å­¦ç®¡ç†ç³»ç»Ÿ - å¼€å‘è§„èŒƒå’Œæ³¨æ„äº‹é¡¹

## ğŸš¨ é‡è¦é—®é¢˜è®°å½•

### APIå“åº”æ ¼å¼ä¸ä¸€è‡´é—®é¢˜

**é—®é¢˜æè¿°**ï¼š
ä¸åŒæ¨¡å—ä½¿ç”¨äº†ä¸åŒçš„APIå“åº”å¤„ç†æ–¹å¼ï¼Œå¯¼è‡´å‰ç«¯ä»£ç ä¸ä¸€è‡´ï¼š

1. **æ¨¡å—1ï¼ˆç»„ç»‡ç®¡ç†ç­‰ï¼‰**ï¼šæœŸæœ› `response.data.data.data` å’Œ `response.data.data.total`
2. **æ¨¡å—2ï¼ˆè®¾å¤‡ç®¡ç†ç­‰ï¼‰**ï¼šæœŸæœ› `response.data.success` å’Œ `response.data.data.data`

**å…·ä½“è¡¨ç°**ï¼š
```javascript
// æ¨¡å—1çš„å¤„ç†æ–¹å¼ï¼ˆç»„ç»‡ç®¡ç†ï¼‰
users.value = response.data.data.data
total.value = response.data.data.total

// æ¨¡å—2çš„å¤„ç†æ–¹å¼ï¼ˆè®¾å¤‡ç®¡ç†ï¼‰
if (response.data.success) {
  tableData.value = response.data.data.data
  pagination.total = response.data.data.total
}
```

**æ ‡å‡†åŒ–è§£å†³æ–¹æ¡ˆ**ï¼š
æ‰€æœ‰æ–°å¼€å‘çš„æ¨¡å—å¿…é¡»ç»Ÿä¸€ä½¿ç”¨ä»¥ä¸‹å“åº”æ ¼å¼ï¼š

```javascript
// åç«¯å“åº”æ ¼å¼ï¼ˆLaravelï¼‰
{
  "success": true,
  "message": "æ“ä½œæˆåŠŸ",
  "data": {
    "data": [...],      // å®é™…æ•°æ®
    "total": 100,       // æ€»æ•°
    "current_page": 1,  // å½“å‰é¡µ
    "per_page": 20      // æ¯é¡µæ•°é‡
  }
}

// å‰ç«¯å¤„ç†æ–¹å¼ï¼ˆç»Ÿä¸€æ ‡å‡†ï¼‰
const loadData = async () => {
  try {
    const response = await api.getList(params)
    if (response.data.success) {
      tableData.value = response.data.data.data
      pagination.total = response.data.data.total
    }
  } catch (error) {
    ElMessage.error('è·å–æ•°æ®å¤±è´¥ï¼š' + error.message)
  }
}
```

## ğŸ“‹ å¼€å‘è§„èŒƒ

### 1. åç«¯å¼€å‘è§„èŒƒ

#### APIå“åº”æ ¼å¼
```php
// æˆåŠŸå“åº”
return response()->json([
    'success' => true,
    'message' => 'æ“ä½œæˆåŠŸ',
    'data' => $data
]);

// é”™è¯¯å“åº”
return response()->json([
    'success' => false,
    'message' => 'é”™è¯¯ä¿¡æ¯',
    'errors' => $errors
], 400);
```

#### æ§åˆ¶å™¨è§„èŒƒ
```php
class ExampleController extends Controller
{
    public function index(Request $request)
    {
        // æƒé™æ£€æŸ¥
        $user = $request->user();
        
        // æ•°æ®æŸ¥è¯¢ï¼ˆè€ƒè™‘æƒé™è¿‡æ»¤ï¼‰
        $query = Model::query();
        if ($user->user_type !== 'sysadmin') {
            $query->where('organization_id', $user->organization_id);
        }
        
        // åˆ†é¡µ
        $data = $query->paginate($request->get('per_page', 20));
        
        return response()->json([
            'success' => true,
            'data' => $data
        ]);
    }
}
```

### 2. å‰ç«¯å¼€å‘è§„èŒƒ

#### APIè°ƒç”¨æ ‡å‡†
```javascript
// APIæ–‡ä»¶ç»“æ„
export const exampleApi = {
  getList(params) {
    return request.get('/examples', { params })
  },
  
  getDetail(id) {
    return request.get(`/examples/${id}`)
  },
  
  create(data) {
    return request.post('/examples', data)
  },
  
  update(id, data) {
    return request.put(`/examples/${id}`, data)
  },
  
  delete(id) {
    return request.delete(`/examples/${id}`)
  }
}
```

#### ç»„ä»¶æ•°æ®å¤„ç†æ ‡å‡†
```javascript
// åˆ—è¡¨é¡µé¢æ ‡å‡†ç»“æ„
const tableData = ref([])
const loading = ref(false)
const pagination = reactive({
  current: 1,
  size: 20,
  total: 0
})

const loadData = async () => {
  loading.value = true
  try {
    const params = {
      page: pagination.current,
      per_page: pagination.size,
      ...searchForm
    }
    
    const response = await exampleApi.getList(params)
    if (response.data.success) {
      tableData.value = response.data.data.data
      pagination.total = response.data.data.total
    }
  } catch (error) {
    ElMessage.error('è·å–æ•°æ®å¤±è´¥ï¼š' + error.message)
  } finally {
    loading.value = false
  }
}
```

### 3. æ•°æ®åº“è®¾è®¡è§„èŒƒ

#### è¡¨å‘½åè§„èŒƒ
- ä½¿ç”¨å¤æ•°å½¢å¼ï¼š`users`, `organizations`, `experiment_catalogs`
- å…³è”è¡¨ä½¿ç”¨å•æ•°ï¼š`user_role`, `organization_user`
- ä½¿ç”¨ä¸‹åˆ’çº¿åˆ†éš”ï¼š`experiment_catalogs`, `curriculum_standards`

#### å­—æ®µè§„èŒƒ
```sql
-- å¿…éœ€å­—æ®µ
id bigint(20) UNSIGNED NOT NULL AUTO_INCREMENT
created_at timestamp NULL DEFAULT NULL
updated_at timestamp NULL DEFAULT NULL

-- è½¯åˆ é™¤
deleted_at timestamp NULL DEFAULT NULL

-- ç»„ç»‡å…³è”
organization_id bigint(20) UNSIGNED COMMENT 'ç»„ç»‡æœºæ„ID'

-- åˆ›å»ºè€…
creator_id bigint(20) UNSIGNED COMMENT 'åˆ›å»ºè€…ID'

-- çŠ¶æ€å­—æ®µ
status enum('active','inactive') NOT NULL DEFAULT 'active'
```

## ğŸ”§ æŠ€æœ¯æ ˆè§„èŒƒ

### åç«¯æŠ€æœ¯æ ˆ
- **æ¡†æ¶**ï¼šLaravel 11
- **æ•°æ®åº“**ï¼šMySQL 8.0+
- **è®¤è¯**ï¼šLaravel Sanctum
- **APIè®¾è®¡**ï¼šRESTful
- **ä»£ç è§„èŒƒ**ï¼šPSR-12

### å‰ç«¯æŠ€æœ¯æ ˆ
- **æ¡†æ¶**ï¼šVue 3 + Composition API
- **UIç»„ä»¶**ï¼šElement Plus
- **æ„å»ºå·¥å…·**ï¼šVite
- **çŠ¶æ€ç®¡ç†**ï¼šPinia
- **HTTPå®¢æˆ·ç«¯**ï¼šAxios
- **ä»£ç è§„èŒƒ**ï¼šESLint + Prettier

## ğŸ›¡ï¸ å®‰å…¨è§„èŒƒ

### æƒé™æ§åˆ¶
```php
// æ§åˆ¶å™¨ä¸­çš„æƒé™æ£€æŸ¥
public function index(Request $request)
{
    $user = $request->user();
    
    // ç³»ç»Ÿç®¡ç†å‘˜å¯ä»¥æŸ¥çœ‹æ‰€æœ‰æ•°æ®
    if ($user->user_type === 'sysadmin') {
        $query = Model::query();
    } else {
        // æ™®é€šç”¨æˆ·åªèƒ½æŸ¥çœ‹æœ¬ç»„ç»‡æ•°æ®
        $query = Model::where('organization_id', $user->organization_id);
    }
    
    // ç»§ç»­å¤„ç†...
}
```

### æ•°æ®éªŒè¯
```php
// ä½¿ç”¨FormRequestè¿›è¡Œæ•°æ®éªŒè¯
class StoreExampleRequest extends FormRequest
{
    public function rules()
    {
        return [
            'name' => 'required|string|max:255',
            'email' => 'required|email|unique:examples',
            'organization_id' => 'required|exists:organizations,id'
        ];
    }
}
```

## ğŸ“ æ–‡ä»¶ç»„ç»‡è§„èŒƒ

### åç«¯æ–‡ä»¶ç»“æ„
```
backend/
â”œâ”€â”€ app/Http/Controllers/Api/
â”‚   â”œâ”€â”€ ExperimentCatalogController.php
â”‚   â”œâ”€â”€ CurriculumStandardController.php
â”‚   â””â”€â”€ ...
â”œâ”€â”€ app/Models/
â”‚   â”œâ”€â”€ ExperimentCatalog.php
â”‚   â”œâ”€â”€ CurriculumStandard.php
â”‚   â””â”€â”€ ...
â”œâ”€â”€ app/Http/Requests/
â”‚   â”œâ”€â”€ StoreExperimentCatalogRequest.php
â”‚   â””â”€â”€ ...
â””â”€â”€ database/migrations/
```

### å‰ç«¯æ–‡ä»¶ç»“æ„
```
frontend/src/
â”œâ”€â”€ views/
â”‚   â”œâ”€â”€ experiment/
â”‚   â”œâ”€â”€ equipment/
â”‚   â””â”€â”€ ...
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ common/
â”‚   â””â”€â”€ ...
â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ experiment.js
â”‚   â”œâ”€â”€ equipment.js
â”‚   â””â”€â”€ ...
â”œâ”€â”€ stores/
â”‚   â”œâ”€â”€ auth.js
â”‚   â””â”€â”€ ...
â””â”€â”€ utils/
```

## ğŸ§ª æµ‹è¯•è§„èŒƒ

### æµ‹è¯•è´¦æˆ·
```
ç³»ç»Ÿç®¡ç†å‘˜: sysadmin / 123456
å­¦åŒºç®¡ç†å‘˜: lianzhou_admin / 123456  
æ ¡é•¿ç”¨æˆ·: dongcheng_principal / 123456
```

### APIæµ‹è¯•
æ¯ä¸ªæ–°åŠŸèƒ½éƒ½å¿…é¡»åŒ…å«ï¼š
1. å•å…ƒæµ‹è¯•
2. åŠŸèƒ½æµ‹è¯•
3. æƒé™æµ‹è¯•
4. è¾¹ç•Œæ¡ä»¶æµ‹è¯•

## ğŸ“ ä»£ç æäº¤è§„èŒƒ

### Gitæäº¤ä¿¡æ¯æ ¼å¼
```
type(scope): description

feat(experiment): æ·»åŠ å®éªŒç›®å½•ç®¡ç†åŠŸèƒ½
fix(auth): ä¿®å¤ç™»å½•tokenè¿‡æœŸé—®é¢˜
docs(readme): æ›´æ–°é¡¹ç›®æ–‡æ¡£
style(ui): è°ƒæ•´è¡¨æ ¼æ ·å¼
refactor(api): é‡æ„APIå“åº”æ ¼å¼
test(unit): æ·»åŠ ç”¨æˆ·ç®¡ç†å•å…ƒæµ‹è¯•
```

### åˆ†æ”¯ç®¡ç†
- `main`: ä¸»åˆ†æ”¯ï¼Œç¨³å®šç‰ˆæœ¬
- `develop`: å¼€å‘åˆ†æ”¯
- `feature/xxx`: åŠŸèƒ½åˆ†æ”¯
- `hotfix/xxx`: ç´§æ€¥ä¿®å¤åˆ†æ”¯

## ğŸ”„ æŒç»­é›†æˆ

### éƒ¨ç½²æ£€æŸ¥æ¸…å•
- [ ] æ•°æ®åº“è¿ç§»å·²æ‰§è¡Œ
- [ ] ç¯å¢ƒå˜é‡å·²é…ç½®
- [ ] ä¾èµ–åŒ…å·²å®‰è£…
- [ ] æƒé™é…ç½®æ­£ç¡®
- [ ] APIæµ‹è¯•é€šè¿‡
- [ ] å‰ç«¯æ„å»ºæˆåŠŸ

---

**é‡è¦æé†’**ï¼šåœ¨å¼€å‘æ–°æ¨¡å—æ—¶ï¼Œè¯·ä¸¥æ ¼éµå¾ªæœ¬æ–‡æ¡£çš„è§„èŒƒï¼Œç‰¹åˆ«æ˜¯APIå“åº”æ ¼å¼çš„ç»Ÿä¸€æ€§ã€‚å¦‚æœ‰ç–‘é—®ï¼Œè¯·å‚è€ƒå·²å®Œæˆçš„æ¨¡å—2ï¼ˆè®¾å¤‡ç®¡ç†ï¼‰çš„å®ç°æ–¹å¼ã€‚
